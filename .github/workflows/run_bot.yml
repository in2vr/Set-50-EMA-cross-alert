name: Daily Stock Scanner

on:
  # 1. ตั้งเวลาทำงาน (Cron Job)
  schedule:
    # เวลาใน GitHub เป็น UTC (ช้ากว่าไทย 7 ชม.)
    # อยากให้รัน 17:30 น. ไทย = 10:30 UTC
    # รูปแบบ: นาที ชั่วโมง วัน เดือน วันในสัปดาห์(1=จันทร์, 5=ศุกร์)
    - cron: '30 10 * * 1-5'
  
  # 2. ปุ่มกดรันเอง (เผื่ออยากเทส)
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      - name: Run scanner script
        env:
          # ส่งค่า Secret เข้าไปใน Python Script
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python telegram_set50_scan.py
